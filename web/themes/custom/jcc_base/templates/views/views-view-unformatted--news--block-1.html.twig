{#
/**
 * @file
 * Default theme implementation to display a view of unformatted rows.
 *
 * Available variables:
 * - title: The title of this group of rows. May be empty.
 * - rows: A list of the view's row items.
 *   - attributes: The row's HTML attributes.
 *   - content: The row's content.
 * - view: The view object.
 * - default_row_class: A flag indicating whether default classes should be
 *   used on rows.
 *
 * @see template_preprocess_views_view_unformatted()
 *
 * @ingroup themeable
 */
#}
{% if view.title %}
  {% set header_title = view.title|t %}
{% else %}
  {% set header_title = 'News, Updates & Notices Default' %}
{% endif %}

{% set cards = [] %}
{% for row in rows %}
  {%
    set row_classes = [
    default_row_class ? 'views-row',
  ]
  %}

  {% set brow = row.content['#row']._entity.created.value|date("M j, Y") %}
  {% set title = row.content['#row']._entity.title.value %}
  {% set excerpt = row.content['#row']._entity.body.value|striptags %}
  {% set url_node = row.content['#row']._entity.nid[0].value %}
  {% set url = path('entity.node.canonical', {'node': url_node }) %}
  {% set read_more_text= row.content['#view'].field.view_node.last_render_text %}

  {% set recent_news_card = {
    "brow": brow,
    "title": title,
    "excerpt": excerpt,
    "url": url,
    "read_more": {
      "label": read_more_text,
      "url": url
    }
  } %}

  {% set cards = cards|merge([recent_news_card]) %}
{% endfor %}

{% set button_text = "More News" %}
{% set button_url = "/news" %}

{% include '@organisms/sections/cards-with-list/cards-with-list.twig' with {
  cards_with_list: {
    headergroup: {
      brow: 'hidden',
      title: header_title,
    },
    cards: cards,
    button: {
      text: button_text,
      url: button_url,
      style: 'primary',
    },
  }
} %}
